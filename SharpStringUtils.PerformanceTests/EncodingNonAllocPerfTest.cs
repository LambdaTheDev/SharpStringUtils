using System;
using System.Text;
using BenchmarkDotNet.Attributes;
using LambdaTheDev.SharpStringUtils.Encodings;

namespace SharpStringUtils.PerformanceTests
{
    [MemoryDiagnoser]
    public class EncodingNonAllocPerfTest
    {
        private readonly UTF8Encoding _utf8 = new UTF8Encoding();
        private readonly EncodingNonAlloc _nonAlloc = new EncodingNonAlloc(new UTF8Encoding());

        private readonly string[] _strings = new[]
        {
            "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"
        };
        

        [Benchmark]
        public void BenchmarkSystem()
        {
            foreach (var str in _strings)
            {
                byte[] bytes = _utf8.GetBytes(str);
            }
        }

        [Benchmark]
        public void BenchmarkNonAlloc()
        {
            foreach (var str in _strings)
            {
                ArraySegment<byte> bytes = _nonAlloc.GetBytesNonAlloc(str);
            }
        }
    }
}